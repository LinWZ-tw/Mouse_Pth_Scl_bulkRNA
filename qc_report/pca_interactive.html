<!DOCTYPE html>
<html>
<head>
    <title>Interactive PCA Analysis</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 5px;
        }
        .control-panel {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .control-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
        }
        .checkbox-item input[type="checkbox"] {
            margin-right: 8px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .checkbox-item label {
            cursor: pointer;
            font-weight: 500;
        }
        .pc-selector {
            margin-top: 10px;
        }
        .pc-selector label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .pc-selector select {
            width: 100%;
            padding: 8px;
            font-size: 14px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .plot-container {
            margin: 30px 0;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .info-box {
            background-color: #d1ecf1;
            border-left: 4px solid #0c5460;
            padding: 15px;
            margin: 20px 0;
        }
        .button-group {
            margin-top: 15px;
        }
        .btn {
            padding: 8px 16px;
            margin-right: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        .btn-primary:hover {
            background-color: #2980b9;
        }
        .btn-secondary {
            background-color: #95a5a6;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #7f8c8d;
        }
        .summary {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .variance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 13px;
        }
        .variance-table th {
            background-color: #3498db;
            color: white;
            padding: 10px;
            text-align: left;
        }
        .variance-table td {
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }
        .variance-table tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Interactive PCA Analysis</h1>

        <div class="summary">
            <h3>Analysis Summary</h3>
            <p><strong>Total Samples:</strong> 65</p>
            <p><strong>Groups:</strong> PTH (4w, 12w), SCL (2w, 10w), Veh (2w, 4w, 10w, 12w)</p>
            <p><strong>Variance explained by PC1-PC3:</strong> 28.86%, 14.27%, 9.38%</p>
            <p><strong>Total variance (first 3 PCs):</strong> 52.50%</p>
        </div>

        <div class="info-box">
            <strong>How to use:</strong>
            <ul>
                <li>Select/deselect groups using the checkboxes below</li>
                <li>Choose which principal components to visualize using the dropdowns</li>
                <li>Use "Select All" or "Clear All" buttons for quick selection</li>
                <li>Hover over points to see sample details</li>
                <li>Click and drag to pan, use scroll to zoom</li>
            </ul>
        </div>

        <h2>Principal Components Variance Explained</h2>
        <table class="variance-table">
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Variance (%)</th>
                    <th>Cumulative Variance (%)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>PC1</td>
                    <td>28.86</td>
                    <td>28.86</td>
                </tr>
                <tr>
                    <td>PC2</td>
                    <td>14.27</td>
                    <td>43.12</td>
                </tr>
                <tr>
                    <td>PC3</td>
                    <td>9.38</td>
                    <td>52.50</td>
                </tr>
                <tr>
                    <td>PC4</td>
                    <td>5.09</td>
                    <td>57.59</td>
                </tr>
                <tr>
                    <td>PC5</td>
                    <td>4.14</td>
                    <td>61.72</td>
                </tr>
                <tr>
                    <td>PC6</td>
                    <td>3.65</td>
                    <td>65.37</td>
                </tr>
                <tr>
                    <td>PC7</td>
                    <td>2.83</td>
                    <td>68.20</td>
                </tr>
                <tr>
                    <td>PC8</td>
                    <td>2.39</td>
                    <td>70.59</td>
                </tr>
                <tr>
                    <td>PC9</td>
                    <td>2.07</td>
                    <td>72.66</td>
                </tr>
                <tr>
                    <td>PC10</td>
                    <td>1.86</td>
                    <td>74.52</td>
                </tr>
            </tbody>
        </table>

        <div class="control-panel">
            <h3>Plot Controls</h3>

            <div class="control-row">
                <div>
                    <h4>Select Groups to Display</h4>
                    <div class="checkbox-group" id="groupCheckboxes"></div>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="selectAll()">Select All</button>
                        <button class="btn btn-secondary" onclick="clearAll()">Clear All</button>
                    </div>
                </div>

                <div class="pc-selector">
                    <h4>Select Principal Components</h4>
                    <label for="pcX">X-axis:</label>
                    <select id="pcX" onchange="updatePlot()">
                        <option value="PC1" selected>PC1 (28.86%)</option>
                        <option value="PC2">PC2 (14.27%)</option>
                        <option value="PC3">PC3 (9.38%)</option>
                        <option value="PC4">PC4 (5.09%)</option>
                        <option value="PC5">PC5 (4.14%)</option>
                        <option value="PC6">PC6 (3.65%)</option>
                        <option value="PC7">PC7 (2.83%)</option>
                        <option value="PC8">PC8 (2.39%)</option>
                        <option value="PC9">PC9 (2.07%)</option>
                        <option value="PC10">PC10 (1.86%)</option>
                    </select>

                    <label for="pcY">Y-axis:</label>
                    <select id="pcY" onchange="updatePlot()">
                        <option value="PC1">PC1 (28.86%)</option>
                        <option value="PC2" selected>PC2 (14.27%)</option>
                        <option value="PC3">PC3 (9.38%)</option>
                        <option value="PC4">PC4 (5.09%)</option>
                        <option value="PC5">PC5 (4.14%)</option>
                        <option value="PC6">PC6 (3.65%)</option>
                        <option value="PC7">PC7 (2.83%)</option>
                        <option value="PC8">PC8 (2.39%)</option>
                        <option value="PC9">PC9 (2.07%)</option>
                        <option value="PC10">PC10 (1.86%)</option>
                    </select>
                </div>
            </div>
        </div>

        <h2>PCA Plot</h2>
        <div class="plot-container" id="pca2d"></div>
    </div>

    <script>
        // PCA data parsed from CSV
        const pcaData = [
            {"PC1":-68.07,"PC2":-65.93,"PC3":-54.92,"PC4":44.43,"PC5":-16.81,"PC6":53.83,"PC7":-7.41,"PC8":48.26,"PC9":-39.03,"PC10":15.94,"Sample":"PTH12w_1","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":45.94,"PC2":-22.06,"PC3":21.15,"PC4":0.60,"PC5":-17.66,"PC6":-15.80,"PC7":-19.05,"PC8":-3.21,"PC9":-5.72,"PC10":17.44,"Sample":"PTH12w_2","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":59.87,"PC2":54.53,"PC3":25.63,"PC4":16.89,"PC5":-3.63,"PC6":8.38,"PC7":-1.92,"PC8":-5.48,"PC9":-9.67,"PC10":9.29,"Sample":"PTH12w_3","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":-34.87,"PC2":56.02,"PC3":17.86,"PC4":34.73,"PC5":-18.40,"PC6":15.63,"PC7":-17.84,"PC8":2.64,"PC9":1.36,"PC10":14.66,"Sample":"PTH12w_4","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":-30.65,"PC2":70.97,"PC3":-5.26,"PC4":34.75,"PC5":-18.94,"PC6":-35.34,"PC7":-27.42,"PC8":-10.84,"PC9":8.92,"PC10":-1.47,"Sample":"PTH12w_5","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":-19.23,"PC2":67.06,"PC3":-3.96,"PC4":21.22,"PC5":-12.47,"PC6":-36.57,"PC7":-40.59,"PC8":-14.48,"PC9":-3.19,"PC10":7.81,"Sample":"PTH12w_6","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":-81.19,"PC2":65.47,"PC3":-55.90,"PC4":50.36,"PC5":-37.76,"PC6":-43.58,"PC7":-9.80,"PC8":14.03,"PC9":4.01,"PC10":-16.29,"Sample":"PTH12w_7","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":90.33,"PC2":64.96,"PC3":-21.47,"PC4":18.67,"PC5":-4.67,"PC6":-24.56,"PC7":-13.99,"PC8":-5.34,"PC9":-13.46,"PC10":-1.20,"Sample":"PTH12w_9","Group":"PTHW","Time":12,"GroupTime":"PTH(12w)"},
            {"PC1":-95.15,"PC2":-1.06,"PC3":62.99,"PC4":24.66,"PC5":11.78,"PC6":-27.25,"PC7":-3.50,"PC8":30.03,"PC9":-14.52,"PC10":-8.54,"Sample":"PTH4w_1","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":-95.40,"PC2":-3.63,"PC3":60.45,"PC4":42.86,"PC5":-13.47,"PC6":-40.66,"PC7":-9.86,"PC8":25.62,"PC9":-18.68,"PC10":-8.39,"Sample":"PTH4w_2","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":-15.60,"PC2":-33.75,"PC3":-1.38,"PC4":-12.32,"PC5":-22.13,"PC6":-4.88,"PC7":-2.79,"PC8":13.75,"PC9":-16.42,"PC10":-9.98,"Sample":"PTH4w_3","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":-11.08,"PC2":-14.73,"PC3":-23.70,"PC4":5.49,"PC5":-35.48,"PC6":1.85,"PC7":-6.17,"PC8":6.91,"PC9":-17.83,"PC10":-0.97,"Sample":"PTH4w_4","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":-122.26,"PC2":66.08,"PC3":-15.59,"PC4":15.67,"PC5":-12.33,"PC6":18.07,"PC7":-11.09,"PC8":5.99,"PC9":-8.36,"PC10":53.52,"Sample":"PTH4w_5","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":106.54,"PC2":54.04,"PC3":-10.18,"PC4":0.01,"PC5":-8.37,"PC6":-19.69,"PC7":13.58,"PC8":7.69,"PC9":-0.48,"PC10":-18.78,"Sample":"PTH4w_7","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":-71.74,"PC2":79.46,"PC3":-15.34,"PC4":35.90,"PC5":-15.30,"PC6":1.66,"PC7":2.00,"PC8":27.48,"PC9":6.59,"PC10":-20.14,"Sample":"PTH4w_8","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":-20.63,"PC2":-4.62,"PC3":31.25,"PC4":-8.55,"PC5":-0.32,"PC6":-2.49,"PC7":-15.79,"PC8":18.03,"PC9":-13.84,"PC10":-10.26,"Sample":"PTH4w_9","Group":"PTHW","Time":4,"GroupTime":"PTH(4w)"},
            {"PC1":14.27,"PC2":-25.93,"PC3":47.92,"PC4":-10.49,"PC5":-19.43,"PC6":10.42,"PC7":-29.53,"PC8":-29.98,"PC9":-5.03,"PC10":-7.72,"Sample":"Scl10w_1","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":-22.89,"PC2":-21.69,"PC3":26.76,"PC4":-18.11,"PC5":-19.99,"PC6":23.24,"PC7":-22.77,"PC8":-26.65,"PC9":1.54,"PC10":-7.76,"Sample":"Scl10w_2","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":36.23,"PC2":-31.34,"PC3":36.17,"PC4":-9.77,"PC5":-24.39,"PC6":14.72,"PC7":-19.16,"PC8":-52.63,"PC9":-5.60,"PC10":-3.26,"Sample":"Scl10w_4","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":-83.56,"PC2":-33.60,"PC3":-8.04,"PC4":-38.01,"PC5":-2.70,"PC6":52.56,"PC7":-30.25,"PC8":-29.44,"PC9":10.79,"PC10":-13.03,"Sample":"Scl10w_5","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":9.31,"PC2":39.84,"PC3":-53.25,"PC4":-21.62,"PC5":7.49,"PC6":7.17,"PC7":-26.33,"PC8":-6.52,"PC9":-8.55,"PC10":8.13,"Sample":"Scl10w_6","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":-87.53,"PC2":-32.16,"PC3":3.46,"PC4":-6.25,"PC5":-16.13,"PC6":-9.97,"PC7":-25.05,"PC8":-36.75,"PC9":-6.99,"PC10":-13.59,"Sample":"Scl10w_7","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":-36.13,"PC2":-0.50,"PC3":-34.51,"PC4":71.69,"PC5":81.48,"PC6":6.16,"PC7":4.65,"PC8":-30.48,"PC9":-30.98,"PC10":-18.01,"Sample":"Scl10w_8","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":-92.29,"PC2":32.96,"PC3":-16.89,"PC4":-57.32,"PC5":23.76,"PC6":14.94,"PC7":-17.51,"PC8":-34.80,"PC9":3.15,"PC10":10.05,"Sample":"Scl10w_9","Group":"SCLW","Time":10,"GroupTime":"SCL(10w)"},
            {"PC1":-50.21,"PC2":-32.64,"PC3":-42.78,"PC4":-44.43,"PC5":-28.25,"PC6":-77.11,"PC7":53.16,"PC8":-14.42,"PC9":-29.12,"PC10":40.89,"Sample":"Scl2w_1","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":40.96,"PC2":-18.98,"PC3":83.16,"PC4":16.65,"PC5":-7.76,"PC6":-7.68,"PC7":33.23,"PC8":15.39,"PC9":4.44,"PC10":-21.37,"Sample":"Scl2w_10","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":-131.04,"PC2":68.67,"PC3":-30.81,"PC4":-38.81,"PC5":20.59,"PC6":18.06,"PC7":32.09,"PC8":-7.70,"PC9":8.11,"PC10":-13.39,"Sample":"Scl2w_2","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":-14.79,"PC2":-60.82,"PC3":34.41,"PC4":11.16,"PC5":-25.74,"PC6":-1.71,"PC7":12.80,"PC8":-9.10,"PC9":-10.40,"PC10":-24.73,"Sample":"Scl2w_4","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":-53.79,"PC2":-107.26,"PC3":-0.40,"PC4":-18.65,"PC5":-35.53,"PC6":-22.22,"PC7":0.47,"PC8":1.55,"PC9":8.59,"PC10":-21.92,"Sample":"Scl2w_5","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":38.00,"PC2":-48.67,"PC3":-34.16,"PC4":-18.54,"PC5":-11.09,"PC6":-8.73,"PC7":-35.26,"PC8":3.17,"PC9":14.40,"PC10":14.22,"Sample":"Scl2w_6","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":81.79,"PC2":-119.47,"PC3":42.60,"PC4":20.41,"PC5":-21.39,"PC6":-32.38,"PC7":15.51,"PC8":-17.27,"PC9":-5.95,"PC10":49.71,"Sample":"Scl2w_7","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":125.35,"PC2":-26.39,"PC3":27.99,"PC4":-24.24,"PC5":-7.87,"PC6":-0.48,"PC7":36.74,"PC8":8.54,"PC9":-9.48,"PC10":-15.87,"Sample":"Scl2w_8","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":-73.74,"PC2":63.88,"PC3":-21.40,"PC4":-16.24,"PC5":-2.84,"PC6":-9.76,"PC7":44.02,"PC8":-30.11,"PC9":-5.01,"PC10":-14.40,"Sample":"Scl2w_9","Group":"SCLW","Time":2,"GroupTime":"SCL(2w)"},
            {"PC1":5.28,"PC2":-35.25,"PC3":38.42,"PC4":-29.39,"PC5":3.45,"PC6":-0.57,"PC7":-11.85,"PC8":-1.70,"PC9":14.14,"PC10":-14.74,"Sample":"Veh10w_1","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":-35.54,"PC2":-72.04,"PC3":-6.33,"PC4":-30.98,"PC5":-20.41,"PC6":34.07,"PC7":-4.38,"PC8":21.40,"PC9":6.88,"PC10":3.78,"Sample":"Veh10w_2","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":26.37,"PC2":-73.20,"PC3":-43.60,"PC4":0.67,"PC5":-24.12,"PC6":0.94,"PC7":-0.13,"PC8":8.96,"PC9":6.87,"PC10":-3.46,"Sample":"Veh10w_3","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":83.69,"PC2":-8.62,"PC3":6.83,"PC4":-26.92,"PC5":0.85,"PC6":18.93,"PC7":-6.16,"PC8":-3.39,"PC9":5.43,"PC10":-15.19,"Sample":"Veh10w_4","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":40.92,"PC2":-22.48,"PC3":15.20,"PC4":-14.36,"PC5":-10.27,"PC6":15.81,"PC7":-15.06,"PC8":1.67,"PC9":17.35,"PC10":11.69,"Sample":"Veh10w_5","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":23.48,"PC2":23.61,"PC3":66.10,"PC4":-19.54,"PC5":40.32,"PC6":0.22,"PC7":-25.48,"PC8":44.14,"PC9":12.44,"PC10":15.34,"Sample":"Veh10w_6","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":77.07,"PC2":38.42,"PC3":-11.25,"PC4":30.28,"PC5":2.15,"PC6":25.44,"PC7":6.94,"PC8":-10.85,"PC9":1.68,"PC10":-18.29,"Sample":"Veh10w_8","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":30.06,"PC2":51.02,"PC3":19.70,"PC4":-17.49,"PC5":28.46,"PC6":39.14,"PC7":7.59,"PC8":11.43,"PC9":-8.36,"PC10":35.99,"Sample":"Veh10w_9","Group":"VEHW","Time":10,"GroupTime":"Veh(10w)"},
            {"PC1":-86.53,"PC2":-55.62,"PC3":-66.56,"PC4":-0.77,"PC5":-3.61,"PC6":57.81,"PC7":-10.71,"PC8":17.38,"PC9":2.80,"PC10":-15.40,"Sample":"Veh12w_1","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":-15.92,"PC2":-31.85,"PC3":-52.63,"PC4":19.84,"PC5":-13.99,"PC6":12.18,"PC7":-10.52,"PC8":8.11,"PC9":-19.34,"PC10":-4.81,"Sample":"Veh12w_2","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":31.76,"PC2":-74.64,"PC3":-27.31,"PC4":12.16,"PC5":5.39,"PC6":14.50,"PC7":21.62,"PC8":5.81,"PC9":0.28,"PC10":-10.54,"Sample":"Veh12w_3","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":59.69,"PC2":64.06,"PC3":27.07,"PC4":0.29,"PC5":18.98,"PC6":17.11,"PC7":-14.99,"PC8":7.69,"PC9":22.85,"PC10":3.86,"Sample":"Veh12w_5","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":68.95,"PC2":22.67,"PC3":36.29,"PC4":15.04,"PC5":-3.77,"PC6":14.74,"PC7":1.21,"PC8":-17.25,"PC9":13.61,"PC10":10.23,"Sample":"Veh12w_6","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":52.69,"PC2":7.39,"PC3":-82.52,"PC4":22.57,"PC5":-27.49,"PC6":10.92,"PC7":47.95,"PC8":-2.15,"PC9":-1.11,"PC10":-14.93,"Sample":"Veh12w_7","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":115.42,"PC2":16.72,"PC3":-26.68,"PC4":9.72,"PC5":-13.32,"PC6":-22.45,"PC7":1.27,"PC8":-26.38,"PC9":11.40,"PC10":-15.93,"Sample":"Veh12w_8","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":77.20,"PC2":-81.36,"PC3":-31.11,"PC4":38.14,"PC5":106.22,"PC6":-12.57,"PC7":-5.47,"PC8":-19.70,"PC9":-40.86,"PC10":-1.76,"Sample":"Veh12w_9","Group":"VEHW","Time":12,"GroupTime":"Veh(12w)"},
            {"PC1":14.69,"PC2":58.84,"PC3":-22.85,"PC4":-32.35,"PC5":4.81,"PC6":-19.12,"PC7":1.67,"PC8":11.56,"PC9":11.25,"PC10":15.50,"Sample":"Veh2w_1","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":6.91,"PC2":-6.52,"PC3":28.99,"PC4":25.07,"PC5":-4.49,"PC6":47.78,"PC7":42.82,"PC8":6.22,"PC9":-30.50,"PC10":38.16,"Sample":"Veh2w_10","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":-132.28,"PC2":47.03,"PC3":-26.85,"PC4":-61.45,"PC5":34.77,"PC6":-0.05,"PC7":39.18,"PC8":0.57,"PC9":-9.72,"PC10":-19.94,"Sample":"Veh2w_2","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":-16.16,"PC2":6.20,"PC3":12.70,"PC4":-8.79,"PC5":-4.47,"PC6":-12.00,"PC7":-1.90,"PC8":4.24,"PC9":16.77,"PC10":-12.20,"Sample":"Veh2w_3","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":210.85,"PC2":12.94,"PC3":-130.26,"PC4":-41.55,"PC5":5.68,"PC6":-21.47,"PC7":-19.40,"PC8":47.72,"PC9":14.41,"PC10":-7.39,"Sample":"Veh2w_6","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":-115.06,"PC2":-44.82,"PC3":24.16,"PC4":-68.38,"PC5":44.34,"PC6":-48.28,"PC7":5.36,"PC8":29.73,"PC9":9.96,"PC10":10.41,"Sample":"Veh2w_7","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":-84.76,"PC2":-100.98,"PC3":-52.47,"PC4":78.23,"PC5":42.08,"PC6":-11.65,"PC7":27.11,"PC8":-14.36,"PC9":103.05,"PC10":25.59,"Sample":"Veh2w_8","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":-5.53,"PC2":26.99,"PC3":29.42,"PC4":-26.67,"PC5":13.27,"PC6":12.15,"PC7":36.61,"PC8":-0.08,"PC9":0.72,"PC10":-2.61,"Sample":"Veh2w_9","Group":"VEHW","Time":2,"GroupTime":"Veh(2w)"},
            {"PC1":55.93,"PC2":49.75,"PC3":-4.36,"PC4":-5.08,"PC5":22.69,"PC6":3.79,"PC7":7.79,"PC8":-15.02,"PC9":2.55,"PC10":5.95,"Sample":"Veh4w_10","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"},
            {"PC1":-55.49,"PC2":12.72,"PC3":74.38,"PC4":6.85,"PC5":8.68,"PC6":1.66,"PC7":-0.44,"PC8":33.54,"PC9":21.07,"PC10":-6.97,"Sample":"Veh4w_2","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"},
            {"PC1":3.98,"PC2":-36.80,"PC3":20.87,"PC4":4.49,"PC5":75.53,"PC6":-35.38,"PC7":-36.53,"PC8":2.58,"PC9":-13.37,"PC10":-12.61,"Sample":"Veh4w_4","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"},
            {"PC1":-17.40,"PC2":43.31,"PC3":-22.79,"PC4":-10.03,"PC5":-16.34,"PC6":-11.80,"PC7":1.06,"PC8":-28.24,"PC9":0.56,"PC10":32.38,"Sample":"Veh4w_5","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"},
            {"PC1":121.74,"PC2":19.39,"PC3":-4.21,"PC4":-25.52,"PC5":17.28,"PC6":16.85,"PC7":-3.94,"PC8":13.27,"PC9":2.33,"PC10":18.12,"Sample":"Veh4w_6","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"},
            {"PC1":5.36,"PC2":43.91,"PC3":27.51,"PC4":24.99,"PC5":-10.80,"PC6":8.92,"PC7":7.28,"PC8":2.63,"PC9":19.98,"PC10":-8.47,"Sample":"Veh4w_7","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"},
            {"PC1":59.16,"PC2":43.80,"PC3":70.78,"PC4":27.74,"PC5":-7.06,"PC6":28.04,"PC7":40.00,"PC8":-3.94,"PC9":13.42,"PC10":-1.39,"Sample":"Veh4w_8","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"},
            {"PC1":56.73,"PC2":-23.28,"PC3":41.51,"PC4":-19.60,"PC5":0.94,"PC6":-11.52,"PC7":16.32,"PC8":0.52,"PC9":-2.15,"PC10":-10.95,"Sample":"Veh4w_9","Group":"VEHW","Time":4,"GroupTime":"Veh(4w)"}
        ];

        // Color scheme for groups (different colors for PTH, SCL, Veh)
        const colorMap = {
            "PTH(4w)": "#e74c3c",    // Red
            "PTH(12w)": "#c0392b",   // Dark Red
            "SCL(2w)": "#3498db",    // Blue
            "SCL(10w)": "#2980b9",   // Dark Blue
            "Veh(2w)": "#2ecc71",    // Green
            "Veh(4w)": "#27ae60",    // Dark Green
            "Veh(10w)": "#f39c12",   // Orange
            "Veh(12w)": "#d35400"    // Dark Orange
        };

        // Different marker symbols for each group
        const symbolMap = {
            "PTH(4w)": "circle",
            "PTH(12w)": "square",
            "SCL(2w)": "diamond",
            "SCL(10w)": "cross",
            "Veh(2w)": "triangle-up",
            "Veh(4w)": "triangle-down",
            "Veh(10w)": "star",
            "Veh(12w)": "hexagon"
        };

        // PC variance explained
        const pcVariance = {
            "PC1": "28.86%",
            "PC2": "14.27%",
            "PC3": "9.38%",
            "PC4": "5.09%",
            "PC5": "4.14%",
            "PC6": "3.65%",
            "PC7": "2.83%",
            "PC8": "2.39%",
            "PC9": "2.07%",
            "PC10": "1.86%"
        };

        // Get unique groups
        const groups = [...new Set(pcaData.map(d => d.GroupTime))].sort();

        // Initialize checkboxes
        const checkboxContainer = document.getElementById('groupCheckboxes');
        const selectedGroups = new Set(groups);

        groups.forEach(group => {
            const div = document.createElement('div');
            div.className = 'checkbox-item';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = `checkbox-${group}`;
            checkbox.value = group;
            checkbox.checked = true;
            checkbox.addEventListener('change', updatePlot);

            const label = document.createElement('label');
            label.htmlFor = `checkbox-${group}`;
            label.textContent = group;
            label.style.color = colorMap[group];

            div.appendChild(checkbox);
            div.appendChild(label);
            checkboxContainer.appendChild(div);
        });

        function selectAll() {
            groups.forEach(group => {
                document.getElementById(`checkbox-${group}`).checked = true;
                selectedGroups.add(group);
            });
            updatePlot();
        }

        function clearAll() {
            groups.forEach(group => {
                document.getElementById(`checkbox-${group}`).checked = false;
                selectedGroups.delete(group);
            });
            updatePlot();
        }

        function updatePlot() {
            // Update selected groups
            selectedGroups.clear();
            groups.forEach(group => {
                if (document.getElementById(`checkbox-${group}`).checked) {
                    selectedGroups.add(group);
                }
            });

            // Get selected PCs
            const pcX = document.getElementById('pcX').value;
            const pcY = document.getElementById('pcY').value;

            // Filter data
            const filteredData = pcaData.filter(d => selectedGroups.has(d.GroupTime));

            // Create plot
            const traces = [];

            groups.forEach(group => {
                if (selectedGroups.has(group)) {
                    const groupData = filteredData.filter(d => d.GroupTime === group);
                    traces.push({
                        x: groupData.map(d => d[pcX]),
                        y: groupData.map(d => d[pcY]),
                        mode: 'markers',
                        type: 'scatter',
                        name: group,
                        marker: {
                            size: 12,
                            color: colorMap[group],
                            symbol: symbolMap[group],
                            line: {
                                color: 'white',
                                width: 1.5
                            }
                        },
                        text: groupData.map(d => `${d.Sample}<br>Group: ${d.GroupTime}<br>${pcX}: ${d[pcX].toFixed(2)}<br>${pcY}: ${d[pcY].toFixed(2)}`),
                        hoverinfo: 'text'
                    });
                }
            });

            const layout = {
                title: `PCA: ${pcX} vs ${pcY}`,
                xaxis: {
                    title: `${pcX} (${pcVariance[pcX]})`,
                    zeroline: true,
                    showgrid: true,
                    gridcolor: '#e0e0e0'
                },
                yaxis: {
                    title: `${pcY} (${pcVariance[pcY]})`,
                    zeroline: true,
                    showgrid: true,
                    gridcolor: '#e0e0e0'
                },
                hovermode: 'closest',
                showlegend: true,
                legend: {
                    x: 1.05,
                    y: 1,
                    bgcolor: 'rgba(255, 255, 255, 0.8)',
                    bordercolor: '#ddd',
                    borderwidth: 1
                },
                height: 700,
                plot_bgcolor: '#fafafa'
            };

            const config = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['lasso2d', 'select2d']
            };

            Plotly.newPlot('pca2d', traces, layout, config);
        }

        // Initialize plot
        updatePlot();
    </script>
</body>
</html>
